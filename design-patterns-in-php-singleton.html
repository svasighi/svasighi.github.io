<!DOCTYPE html><html lang="persian" dir="rtl"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>دیزاین پترن ها در php - singleton - شادمهر وثیقی</title><meta name="description" content="singleton چه جاهایی کاربرد داره؟در مهندسی نرم افزار singleton برای محدود کردن تعداد اشیا موجود از کلاس به دقیقا یک عدد است.این مفهوم برای نرم افزارهایی استفاده میشود که وجود یک آبجکت درآن به دقت بیشتر و کاربرد بهترمنجر میشود.باید از دیزاین پترن ها برای حل مشکلات برنامه نویسی استفاده کنیم، نه هرجایی که امکانش وجود داشته باشد و singleton نیز از این قاعده مستثنی نیست.دیزان پترن ها یک لایه از پیچیدگی به برنامه های ما اضافه میکنند.این پترن برای جلوگیری از ایجادِ بیشتر از یک شی، در یک کلاس است. گاها در کلاس هایی مثل logger نیاز میشود اجازه ندهیم بیشتر از یک شی ایجاد شود(به جهت جلوگیری از کانفلیکت دو شیِ این کلاس). این نوعِ طراحی اجازه میدهد کلاس باید به گونه ای طراحی شود که جلوی ایجاد هر شی دیگری را بگیرد..نحوه استفاده از singleton"><meta name="robots" content="index, follow"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://svasighi.github.io/design-patterns-in-php-singleton.html"><link rel="alternate" type="application/atom+xml" href="https://svasighi.github.io/feed.xml"><link rel="alternate" type="application/json" href="https://svasighi.github.io/feed.json"><meta property="og:title" content="دیزاین پترن ها در php - singleton"><meta property="og:image" content="https://svasighi.github.io/media/posts/6/php-design-pattern.jpg"><meta property="og:site_name" content="شادمهر وثیقی - برنامه نویس و دانشجوی مهندسی برق"><meta property="og:description" content="singleton چه جاهایی کاربرد داره؟در مهندسی نرم افزار singleton برای محدود کردن تعداد اشیا موجود از کلاس به دقیقا یک عدد است.این مفهوم برای نرم افزارهایی استفاده میشود که وجود یک آبجکت درآن به دقت بیشتر و کاربرد بهترمنجر میشود.باید از دیزاین پترن ها برای حل مشکلات برنامه نویسی استفاده کنیم، نه هرجایی که امکانش وجود داشته باشد و singleton نیز از این قاعده مستثنی نیست.دیزان پترن ها یک لایه از پیچیدگی به برنامه های ما اضافه میکنند.این پترن برای جلوگیری از ایجادِ بیشتر از یک شی، در یک کلاس است. گاها در کلاس هایی مثل logger نیاز میشود اجازه ندهیم بیشتر از یک شی ایجاد شود(به جهت جلوگیری از کانفلیکت دو شیِ این کلاس). این نوعِ طراحی اجازه میدهد کلاس باید به گونه ای طراحی شود که جلوی ایجاد هر شی دیگری را بگیرد..نحوه استفاده از singleton"><meta property="og:url" content="https://svasighi.github.io/design-patterns-in-php-singleton.html"><meta property="og:type" content="article"><link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><style>h1,h2,h3,h4,h5,h6,.btn,[type=button],[type=submit],button,.navbar .navbar__menu li,.navbar_mobile_sidebar .navbar__menu li,.feed__author,.post__tag,.post__share>a span,.post__nav-link>span,.footer{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}body,h1,.h1,blockquote,.search__input,.author__name,.author__info>p,.feed__item h2,.post__nav-link{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}</style><link rel="stylesheet" href="https://svasighi.github.io/assets/css/style.css?v=1537aeff83125fe55a4d1d562600dfa4"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://svasighi.github.io/design-patterns-in-php-singleton.html"},"headline":"دیزاین پترن ها در php - singleton","datePublished":"2020-03-17T01:06","dateModified":"2020-03-17T03:36","image":{"@type":"ImageObject","url":"https://svasighi.github.io/media/posts/6/php-design-pattern.jpg","height":720,"width":1280},"description":"<h3 class=\"align-right\"><strong>singleton چه جاهایی کاربرد داره؟</strong></h3>\n<p class=\"align-right\">در مهندسی نرم افزار singleton برای محدود کردن تعداد اشیا موجود از کلاس به دقیقا یک عدد است.این مفهوم برای نرم افزارهایی استفاده میشود که وجود یک آبجکت درآن به دقت بیشتر و کاربرد بهترمنجر میشود.</p>\n<p class=\"align-right\">باید از دیزاین پترن ها برای حل مشکلات برنامه نویسی استفاده کنیم، نه هرجایی که امکانش وجود داشته باشد و <code>singleton</code> نیز از این قاعده مستثنی نیست.دیزان پترن ها یک لایه از پیچیدگی به برنامه های ما اضافه میکنند.</p>\n<p class=\"align-right\">این پترن برای جلوگیری از ایجادِ بیشتر از یک شی، در یک کلاس است. گاها در کلاس هایی مثل logger نیاز میشود اجازه ندهیم بیشتر از یک شی ایجاد شود(به جهت جلوگیری از کانفلیکت دو شیِ این کلاس). این نوعِ طراحی اجازه میدهد کلاس باید به گونه ای طراحی شود که جلوی ایجاد هر شی دیگری را بگیرد..</p>\n<h3 class=\"align-right\"><strong>نحوه استفاده از singleton</strong></h3>\n","author":{"@type":"Person","name":"شادمهر وثیقی"},"publisher":{"@type":"Organization","name":"شادمهر وثیقی","logo":{"@type":"ImageObject","url":"https://svasighi.github.io/media/website/Untitled-2.jpg","height":280,"width":280}}}</script><script src="https://svasighi.github.io/assets/js/ls.parent-fit.min.js?v=f8467455ea5c88e3e51a4f212d2632bd"></script><script async src="https://svasighi.github.io/assets/js/lazysizes.min.js?v=6a69d476c93de2b78a72acb259abccea"></script></head><body><div class="site-container"><header class="top" id="js-header"><a class="logo" href="https://svasighi.github.io/"><img src="https://svasighi.github.io/media/website/Untitled-2.jpg" alt="شادمهر وثیقی"></a><div class="site-branding"><p class="site-title"><a href="https://svasighi.github.io/" rel="home">شادمهر وثیقی -</a></p><p class="site-description">برنامه نویس و دانشجوی مهندسی برق</p><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="فهرست" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">فهرست</span></span></button><ul class="navbar__menu"><li><a href="https://svasighi.github.io" title="صفحه نخست" target="_self">صفحه نخست</a></li><li><a href="https://svasighi.github.io/about-me.html" target="_self">about me</a></li></ul></nav></div><div class="search"><div class="search__overlay js-search-overlay"><div class="search__overlay-inner"><form action="https://svasighi.github.io/search.html" class="search__form"><input class="search__input js-search-input" type="search" name="q" placeholder="عبارت موردنطر را واردکنید" autofocus="autofocus"></form><button class="search__close js-search-close" aria-label="بستن">بستن</button></div></div><button class="search__btn js-search-btn" aria-label="جستجو"><svg role="presentation" focusable="false"><use xlink:href="https://svasighi.github.io/assets/svg/svg-map.svg#search"/></svg></button></div></header><main><article class="post"><div class="hero"><figure class="hero__image"><img class="hero__image-img lazyload" data-src="https://svasighi.github.io/media/posts/6/php-design-pattern.jpg" data-srcset="https://svasighi.github.io/media/posts/6/responsive/php-design-pattern-xs.jpg 300w ,https://svasighi.github.io/media/posts/6/responsive/php-design-pattern-sm.jpg 480w ,https://svasighi.github.io/media/posts/6/responsive/php-design-pattern-md.jpg 768w ,https://svasighi.github.io/media/posts/6/responsive/php-design-pattern-lg.jpg 1024w ,https://svasighi.github.io/media/posts/6/responsive/php-design-pattern-xl.jpg 1360w ,https://svasighi.github.io/media/posts/6/responsive/php-design-pattern-2xl.jpg 1600w" data-aspectratio="1.7777777777777777" data-sizes="auto" alt="دیزاین پترن" height="720" width="1280"><figcaption>@shadmehr._.me</figcaption></figure><header class="hero__content"><div class="wrapper"><div class="post__meta"><time datetime="2020-03-17T01:06">01:06:36 20/03/17</time></div><h1>دیزاین پترن ها در php - singleton</h1><div class="post__meta post__meta--author"><img class="lazyload post__author-thumb" data-src="https://svasighi.github.io/media/website/49784686.jpg" alt="شادمهر وثیقی"> <a href="https://svasighi.github.io/authors/shadmehr-vasighi/" class="feed__author invert">شادمهر وثیقی</a></div></div></header></div><div class="wrapper post__entry"><h3 class="align-right"><strong>singleton چه جاهایی کاربرد داره؟</strong></h3><p class="align-right">در مهندسی نرم افزار singleton برای محدود کردن تعداد اشیا موجود از کلاس به دقیقا یک عدد است.این مفهوم برای نرم افزارهایی استفاده میشود که وجود یک آبجکت درآن به دقت بیشتر و کاربرد بهترمنجر میشود.</p><p class="align-right">باید از دیزاین پترن ها برای حل مشکلات برنامه نویسی استفاده کنیم، نه هرجایی که امکانش وجود داشته باشد و <code>singleton</code> نیز از این قاعده مستثنی نیست.دیزان پترن ها یک لایه از پیچیدگی به برنامه های ما اضافه میکنند.</p><p class="align-right">این پترن برای جلوگیری از ایجادِ بیشتر از یک شی، در یک کلاس است. گاها در کلاس هایی مثل logger نیاز میشود اجازه ندهیم بیشتر از یک شی ایجاد شود(به جهت جلوگیری از کانفلیکت دو شیِ این کلاس). این نوعِ طراحی اجازه میدهد کلاس باید به گونه ای طراحی شود که جلوی ایجاد هر شی دیگری را بگیرد..</p><h3 class="align-right"><strong>نحوه استفاده از singleton</strong></h3><p class="align-right">برای درک بیشتر از اهمیت ایجاد یک شی (دسترسی به کلاس) از مفهوم پایگاه داده استفاده میکنیم. در حالت عادی دیتابیس ها به صورت زیر استفاده میشوند که چندان خوب نیست.</p><pre class="prettyprint prettyprinted" style="text-align: left; direction: ltr;"><code><span class="pun">&lt;?</span><span class="pln">php

</span><span class="com">// ایجاد یک شی از کلاس در حالت عادی</span><span class="pln">
$db </span><span class="pun">=</span> <span class="kwd">new</span> <span class="typ">Database</span><span class="pun">;</span>

<span class="com">// تنظیمات</span><span class="pln">
$db</span><span class="pun">-&gt;</span><span class="pln">setHost</span><span class="pun">(</span><span class="str">'127.0.0.1'</span><span class="pun">);</span><span class="pln">
$db</span><span class="pun">-&gt;</span><span class="pln">setPort</span><span class="pun">(</span><span class="lit">3306</span><span class="pun">);</span><span class="pln">
$db</span><span class="pun">-&gt;</span><span class="pln">setUsername</span><span class="pun">(</span><span class="str">'root'</span><span class="pun">);</span><span class="pln">
$db</span><span class="pun">-&gt;</span><span class="pln">setPassword</span><span class="pun">(</span><span class="str">'dont-watch-my-password :)'</span><span class="pun">);</span>

<span class="com">// استفاده از شی</span><span class="pln">
$results </span><span class="pun">=</span><span class="pln"> $db</span><span class="pun">-&gt;</span><span class="kwd">select</span><span class="pun">(</span><span class="str">'users'</span><span class="pun">);</span></code></pre><p class="align-right">خیلی بی معناست که بارها این کانکشن را در فایل های مختلف ایجاد کنیم و از آن استفاده کنیم این کارباعث هدررفت زمان و منابع (ایجاد tcp connection ها و استفاده از مموری میشود). برای جلوگیری از این هدررفت از singleton استفاده میکنیم.</p><p><code></code></p><pre class="prettyprint prettyprinted" style="text-align: left; direction: ltr;"><code><span class="pun">&lt;?</span><span class="pln">php

</span><span class="kwd">class</span><span class="pln"> DB
</span><span class="pun">{</span>
    <span class="com">/**
     * تنها شی ممکن برای کلاس دیتابیس
     * 
     * @var Database
     */</span>
    <span class="kwd">private</span> <span class="kwd">static</span><span class="pln"> $instance</span><span class="pun">;</span>

    <span class="com">/**
     * با private کردن کانستراکتور (سازنده کلاس) از ایجاد اشیا مختلف جلوگیری میشود.
     */</span>
    <span class="kwd">private</span> <span class="kwd">function</span><span class="pln"> __construct
    </span><span class="pun">{</span>
        <span class="com">// man gharare hich kari anjam nadam.</span>
    <span class="pun">}</span>

    <span class="com">/**
     * متدی جها ایجاد شی (دسترسی به کلاس) .
     * 
     * @return Database
     */</span>
    <span class="kwd">public</span> <span class="kwd">static</span> <span class="kwd">function</span><span class="pln"> getInstance</span><span class="pun">()</span>
    <span class="pun">{</span>
        <span class="kwd">if</span> <span class="pun">(</span><span class="pln">is_null</span><span class="pun">(</span><span class="kwd">static</span><span class="pun">::</span><span class="pln">$instance</span><span class="pun">))</span> <span class="pun">{</span>
            <span class="kwd">static</span><span class="pun">::</span><span class="pln">$instance </span><span class="pun">=</span> <span class="kwd">new</span> <span class="typ">Database</span><span class="pun">;</span>
            <span class="kwd">static</span><span class="pun">::</span><span class="pln">$instance</span><span class="pun">-&gt;</span><span class="pln">setHost</span><span class="pun">(</span><span class="str">'127.0.0.1'</span><span class="pun">);</span>
            <span class="kwd">static</span><span class="pun">::</span><span class="pln">$instance</span><span class="pun">-&gt;</span><span class="pln">setPort</span><span class="pun">(</span><span class="lit">3306</span><span class="pun">);</span>
            <span class="kwd">static</span><span class="pun">::</span><span class="pln">$instance</span><span class="pun">-&gt;</span><span class="pln">setUsername</span><span class="pun">(</span><span class="str">'root'</span><span class="pun">);</span>
            <span class="kwd">static</span><span class="pun">::</span><span class="pln">$instance</span><span class="pun">-&gt;</span><span class="pln">setPassword</span><span class="pun">(</span><span class="str">'dont-watch-my-password :)'</span><span class="pun">);</span>
        <span class="pun">}</span>

        <span class="kwd">return</span> <span class="kwd">static</span><span class="pun">::</span><span class="pln">$instance</span><span class="pun">;</span>
    <span class="pun">}</span>

    <span class="com">/**
     * با بازتعریف clone از ایجاد یک کپی از شی جلوگیری میکنیم
     * 
     * @return void
     */</span><span class="pln">
    final </span><span class="kwd">public</span> <span class="kwd">function</span><span class="pln"> __clone</span><span class="pun">()</span>
    <span class="pun">{</span>
        <span class="kwd">throw</span> <span class="kwd">new</span> <span class="typ">Exception</span><span class="pun">(</span><span class="str">'من غیرفعال شده م :( '</span><span class="pun">);</span>
    <span class="pun">}</span>

    <span class="com">/**
     * برای جلوگیری از سریالایز کردن کلاس 
     * چون ممکن است بار ها serialize یا unserialize انجام بشود و در پی آن اشیا مختلف از کلاس ایجاد شود
     * @return void
     */</span><span class="pln">
    final </span><span class="kwd">public</span> <span class="kwd">function</span><span class="pln"> __wakeup</span><span class="pun">()</span>
    <span class="pun">{</span>
        <span class="kwd">throw</span> <span class="kwd">new</span> <span class="typ">Exception</span><span class="pun">(</span><span class="str">'منم غیر فعال شدم :( '</span><span class="pun">);</span>
    <span class="pun">}</span>
<span class="pun">}</span></code></pre><p><code></code></p><p>اسفاده از کلاس ایجاد شده با singleton :</p><pre class="prettyprint prettyprinted" style="text-align: left; direction: ltr;"><code><span class="pun">&lt;?</span><span class="pln">php

</span><span class="com">// ایجاد شی</span><span class="pln">
$db </span><span class="pun">=</span><span class="pln"> DB</span><span class="pun">::</span><span class="pln">getInstance</span><span class="pun">();</span>

<span class="com">// استفاده از شی</span><span class="pln">
$results </span><span class="pun">=</span><span class="pln"> $db</span><span class="pun">-&gt;</span><span class="kwd">select</span><span class="pun">(</span><span class="str">'users'</span><span class="pun">);<br></span></code></pre><h3>نتیجه اخلاقی:</h3><p>با وجود اینکه این پترن اولین پترنی ست که به دانشجوهای مهندسی نرم افزار آموخته میشود، اگر از آن بد استفاده شود میتواند پاشنه ی آشیل نرم افزار شما باشد.</p><p>singleton وقتایی که نیازه فقط یک کپی از کلاس شما وجود داشته باشد بسیار کاربردی ست ولی کاربرد این پترن تنها به این کار ختم نمیشود. خیلی از برنامه نویسان برای جلوگیری ازاستفاده کردن متغیرهای global از این طراحی استفاده میکنند. ولی اینکار توصیه نمیشود. بهتر است از این نوع طراحی در تزریق وابستگی (dependency injection) استفاده کنید.</p></div><footer class="wrapper post__footer"><p class="post__last-updated">آخرین آپدیت : 03:36:21 20/03/17</p><div class="post__share"></div><div class="post__bio bio"><img class="lazyload bio__avatar" data-src="https://svasighi.github.io/media/website/49784686.jpg" alt="شادمهر وثیقی"><div class="bio__info"><h3 class="bio__name"><a href="https://svasighi.github.io/authors/shadmehr-vasighi/" class="invert" rel="author">شادمهر وثیقی</a></h3></div></div></footer></article><nav class="post__nav"><div class="post__nav-inner"><div class="post__nav-prev"><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://svasighi.github.io/assets/svg/svg-map.svg#arrow-prev"/></svg> <a href="https://svasighi.github.io/blogging-set-goals-part-1.html" class="invert post__nav-link" rel="prev"><span>قبلی</span> آموزش وبلاگ نویسی - برنامه ریزی منسجم برای وبلاگ (قسمت دوم بخش اول)</a></div><div class="post__nav-next"><a href="https://svasighi.github.io/shywh-y-bhtr-bry-taaryf-route-h-dr-lrwl.html" class="invert post__nav-link" rel="next"><span>بعدی</span> شیوه ای بهتر برای تعریف route ها در لاراول </a><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://svasighi.github.io/assets/svg/svg-map.svg#arrow-next"/></svg></div></div></nav></main><footer class="footer"><div class="footer__social"><a href="https://instagram.com/shadmehr._.me" aria-label="Instagram"><svg><use xlink:href="https://svasighi.github.io/assets/svg/svg-map.svg#instagram"/></svg></a></div><div class="footer__copyright">ایجاد شده توسط <a href="https://getpublii.com" target="_blank" rel="nofollow noopener noreferrer">Publii</a> بر روی سرور های github</div><button class="footer__bttop js-footer__bttop" aria-label="بازگشت به بالا"><svg><title>بازگشت به بالا</title><use xlink:href="https://svasighi.github.io/assets/svg/svg-map.svg#toparrow"/></svg></button></footer></div><script>window.publiiThemeMenuConfig = {    
        mobileMenuMode: 'overlay',
        animationSpeed: 300,
        submenuWidth: 'auto',
        doubleClickTime: 500,
        mobileMenuExpandableSubmenus: true, 
        relatedContainerForOverlayMenuSelector: '.top',
   };</script><script defer="defer" src="https://svasighi.github.io/assets/js/scripts.min.js?v=205f40927e4a45297a0b266e50ad78d5"></script><script>var lazyFeaturedImage=function lazyFeaturedImage(){var b=document.querySelectorAll(".hero__image-img");for(var a=0;a<b.length;a++){var c=b[a];c.addEventListener("lazyloaded",function(f){var d=f.target.parentNode;d.classList.add("hero__image--overlay")})}};lazyFeaturedImage();</script></body></html>